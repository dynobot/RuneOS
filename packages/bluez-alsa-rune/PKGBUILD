# Maintainer: Henri Derycke <nheir.kim@gmail.com>
pkgname=bluez-alsa-rune
_pkgname=bluez-alsa
pkgver=1.3.1
pkgrel=1
pkgdesc="Bluetooth Audio ALSA Backend"
arch=('x86_64' 'armv6h' 'armv7h')
url="https://github.com/Arkq/bluez-alsa"
license=('MIT')
depends=('bluez-libs' 'glib2' 'libfdk-aac' 'sbc' 'alsa-lib')
makedepends=('git')
#source=("$pkgname::git+https://github.com/Arkq/bluez-alsa.git"
source=("$pkgname::https://github.com/Arkq/bluez-alsa/archive/v$pkgver.zip"
	bluealsa.service
	bluealsa.tmpfiles
	bluealsa.sysusers)
md5sums=('5e22d50acf45acd7da9031f077bd61cb'
         'cf4fb625e446f0e0ab60e7795b764043'
         'e049cc166f97f281bec3a43175849bdc'
         'd77dd60a98613682a149b6e4e32bc5bc')

install=bluealsa.install
#pkgver() {
#	cd "$_pkgname"-"$pkgver"
#	#git describe --long | sed 's/\([^-]*-g\)/r\1/;s/-/./g'
#}

build() {
	cd "$_pkgname"-"$pkgver"
	autoreconf --install
	./configure --prefix=/usr \
	            --enable-aac \
	            --enable-debug
	make
}

package() {
	cd "$_pkgname"-"$pkgver"
	make DESTDIR="$pkgdir/" install
	install -Dm0644 $srcdir/$_pkgname-$pkgver/LICENSE.txt $pkgdir/usr/share/licenses/_$pkgname/LICENSE
	install -Dm0644 $srcdir/bluealsa.tmpfiles $pkgdir/usr/lib/tmpfiles.d/bluealsa.conf
	install -Dm0644 $srcdir/bluealsa.sysusers $pkgdir/usr/lib/sysusers.d/bluealsa.conf
	install -Dm0644 $srcdir/bluealsa.service $pkgdir/usr/lib/systemd/system/bluealsa.service
}
